{"version":3,"file":"js/574.a46e3d1b.js","mappings":"uLAEIA,EAAAA,EAAAA,IAAkB,UAAd,aAAS,G,GAFjBC,IAAA,G,GAAAA,IAAA,G,EAAA,Y,wEACEC,EAAAA,EAAAA,IA2BM,YA1BJC,EACgC,IAArBC,EAAAC,UAAUC,SAAM,WAA3BJ,EAAAA,EAAAA,IAAyD,MAH7DK,EAGuC,uBAAgB,WACnDL,EAAAA,EAAAA,IAgBM,MApBVM,EAAA,EAKMR,EAAAA,EAAAA,IAcQ,eAZNA,EAAAA,EAAAA,IAWQ,6BAVNE,EAAAA,EAAAA,IASKO,EAAAA,GAAA,MAjBfC,EAAAA,EAAAA,IAS2BN,EAAAC,WAARM,K,WADTT,EAAAA,EAAAA,IASK,MAPFD,IAAKU,EAAKC,WACVC,QAAKC,GAAEV,EAAAW,cAAcJ,EAAKK,M,EAE3BhB,EAAAA,EAAAA,IAA4B,UAAxB,SAAKiB,EAAAA,EAAAA,IAAGN,EAAKK,KAAG,IACpBhB,EAAAA,EAAAA,IAA2C,UAAvC,OAAGiB,EAAAA,EAAAA,IAAGN,EAAKO,aAAa,GAAGC,MAAI,IACnCnB,EAAAA,EAAAA,IAA8B,UAA1B,SAAKiB,EAAAA,EAAAA,IAAGN,EAAKS,OAAK,IACtBpB,EAAAA,EAAAA,IAA8B,UAA1B,QAAIiB,EAAAA,EAAAA,IAAGN,EAAKU,QAAM,MAhBlCC,M,cAqBIC,EAAAA,EAAAA,IAMEC,EAAA,CALQC,WAAYrB,EAAAsB,eAtB1B,sBAAAC,EAAA,KAAAA,EAAA,GAAAb,GAsB0BV,EAAAsB,eAAcZ,GACjCc,OAAQxB,EAAAwB,OACRT,KAAMf,EAAAe,KACNU,KAAMzB,EAAAyB,KACNjB,WAAYR,EAAAQ,Y,8FAUnB,GACEkB,WAAY,CAAEC,UAASA,EAAAA,GACvBC,KAAAA,GACE,MAAMJ,GAASK,EAAAA,EAAAA,IAAIC,aAAaC,QAAQ,YAClChB,GAAOc,EAAAA,EAAAA,IAAIC,aAAaC,QAAQ,cAChCN,GAAOI,EAAAA,EAAAA,IAAI,OACXP,GAAiBO,EAAAA,EAAAA,KAAI,GACrBrB,GAAaqB,EAAAA,EAAAA,IAAI,IACjB5B,GAAY4B,EAAAA,EAAAA,IAAI,IACtB,IAAIG,EAAuB,KAE3B,MAAMrB,EAAiBsB,IACrBzB,EAAW0B,MAAQD,EACnBX,EAAeY,OAAQ,CAAI,EAGvBC,EAAyBC,UAC7B,IACE,MAAMC,QAAiBC,EAAAA,EAAMC,KAC3B,sCACA,CACE,GAIJtC,EAAUiC,MAAQG,EAASG,KAC3BC,QAAQC,IAAI,WAAazC,EAAUiC,MAAMhC,OAC3C,CAAE,MAAOyC,GACPF,QAAQE,MAAM,4BAA6BA,EAC7C,GAGIC,EAA2BA,KAC/B,IAAIC,EAAM,2CAA2C9B,EAAKmB,QAC1DF,EAAuB,IAAIc,UAAUD,GAErCb,EAAqBe,OAAS,KAC5BN,QAAQC,IAAI,yCAAyC,EAGvDV,EAAqBgB,QAAU,KAC7BP,QAAQC,IAAI,yCAAyC,EAGvDV,EAAqBiB,QAAWN,IAC9BF,QAAQE,MAAM,8BAA+BA,EAAM,CACpD,EAiBH,OAdAO,EAAAA,EAAAA,KAAU,KAERN,IAEAT,GAAwB,KAI1BgB,EAAAA,EAAAA,KAAY,KACNnB,GACFA,EAAqBoB,OACvB,IAGK,CACL5B,SACAT,OACAU,OACAxB,YACAO,aACAc,iBACAX,gBAEJ,G,UCvGF,MAAM0C,GAA2B,OAAgB,EAAQ,CAAC,CAAC,SAASC,KAEpE,O","sources":["webpack://test1/./src/admin/modules/components/chat/ChatService.vue","webpack://test1/./src/admin/modules/components/chat/ChatService.vue?d985"],"sourcesContent":["<template>\r\n  <div>\r\n    <h1>실시간 채팅 지원</h1>\r\n    <div v-if=\"chatrooms.length === 0\">실시간 채팅 지원이 없습니다.</div>\r\n    <div v-else>\r\n      <table>\r\n        <!-- 내용, 날짜, 상태 -->\r\n        <tbody>\r\n          <tr\r\n            v-for=\"chat in chatrooms\"\r\n            :key=\"chat.chatroomId\"\r\n            @click=\"openChatModal(chat._id)\"\r\n          >\r\n            <td>rid: {{ chat._id }}</td>\r\n            <td>닉: {{ chat.participants[0].nick }}</td>\r\n            <td>생성일: {{ chat.credt }}</td>\r\n            <td>상태: {{ chat.status }}</td>\r\n          </tr>\r\n        </tbody>\r\n      </table>\r\n    </div>\r\n    <ChatModal\r\n      v-model:modelValue=\"isModalVisible\"\r\n      :userId=\"userId\"\r\n      :nick=\"nick\"\r\n      :role=\"role\"\r\n      :chatroomId=\"chatroomId\"\r\n    />\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { ref, onMounted, onUnmounted } from \"vue\";\r\nimport axios from \"axios\";\r\nimport ChatModal from \"../../../../user/modules/components/chat/ChatModal.vue\";\r\n\r\nexport default {\r\n  components: { ChatModal },\r\n  setup() {\r\n    const userId = ref(localStorage.getItem(\"adminId\"));\r\n    const nick = ref(localStorage.getItem(\"adminNick\"));\r\n    const role = ref(\"ADM\");\r\n    const isModalVisible = ref(false);\r\n    const chatroomId = ref(\"\");\r\n    const chatrooms = ref([]);\r\n    let activeAdminChkSocket = null;\r\n\r\n    const openChatModal = (id) => {\r\n      chatroomId.value = id;\r\n      isModalVisible.value = true;\r\n    };\r\n\r\n    const getLiveChatWaitingList = async () => {\r\n      try {\r\n        const response = await axios.post(\r\n          \"/api/admin/chat/liveChatWaitingList\",\r\n          {\r\n            //id: userId.value,\r\n          }\r\n        );\r\n\r\n        chatrooms.value = response.data;\r\n        console.log(\"length: \" + chatrooms.value.length);\r\n      } catch (error) {\r\n        console.error(\"Error fetching chat list:\", error);\r\n      }\r\n    };\r\n\r\n    const openActiveAdminChkSocket = () => {\r\n      let url = `ws://localhost:9090/ws/adminOnList?nick=${nick.value}`;\r\n      activeAdminChkSocket = new WebSocket(url);\r\n\r\n      activeAdminChkSocket.onopen = () => {\r\n        console.log(\"activeAdminChkSocket connection opened\");\r\n      };\r\n\r\n      activeAdminChkSocket.onclose = () => {\r\n        console.log(\"activeAdminChkSocket connection closed\");\r\n      };\r\n\r\n      activeAdminChkSocket.onerror = (error) => {\r\n        console.error(\"activeAdminChkSocket error:\", error);\r\n      };\r\n    };\r\n\r\n    onMounted(() => {\r\n      // 웹소켓 연결\r\n      openActiveAdminChkSocket();\r\n      // 실시간 상담 대기 리스트\r\n      getLiveChatWaitingList();\r\n    });\r\n\r\n    // 다른 페이지로 이동시 웹소켓 close\r\n    onUnmounted(() => {\r\n      if (activeAdminChkSocket) {\r\n        activeAdminChkSocket.close();\r\n      }\r\n    });\r\n\r\n    return {\r\n      userId,\r\n      nick,\r\n      role,\r\n      chatrooms,\r\n      chatroomId,\r\n      isModalVisible,\r\n      openChatModal,\r\n    };\r\n  },\r\n};\r\n</script>\r\n","import { render } from \"./ChatService.vue?vue&type=template&id=1093bc8c\"\nimport script from \"./ChatService.vue?vue&type=script&lang=js\"\nexport * from \"./ChatService.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["_createElementVNode","key","_createElementBlock","_hoisted_1","$setup","chatrooms","length","_hoisted_2","_hoisted_3","_Fragment","_renderList","chat","chatroomId","onClick","$event","openChatModal","_id","_toDisplayString","participants","nick","credt","status","_hoisted_4","_createVNode","_component_ChatModal","modelValue","isModalVisible","_cache","userId","role","components","ChatModal","setup","ref","localStorage","getItem","activeAdminChkSocket","id","value","getLiveChatWaitingList","async","response","axios","post","data","console","log","error","openActiveAdminChkSocket","url","WebSocket","onopen","onclose","onerror","onMounted","onUnmounted","close","__exports__","render"],"sourceRoot":""}