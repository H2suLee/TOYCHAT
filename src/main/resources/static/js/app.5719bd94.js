(function(){"use strict";var e={2371:function(e,t,n){var o=n(5130),a=n(6768);const r={key:1},i={key:1};function l(e,t,n,l,c,u){const s=(0,a.g2)("Login"),d=(0,a.g2)("Header"),m=(0,a.g2)("LeftMenu"),f=(0,a.g2)("AdminLogin"),p=(0,a.g2)("AdminHeader"),g=(0,a.g2)("AdminLeftMenu"),v=(0,a.g2)("router-view");return(0,a.uX)(),(0,a.CE)("div",null,[(0,a.bo)((0,a.Lk)("div",null,[(0,a.Lk)("div",null,[u.isLogin?((0,a.uX)(),(0,a.CE)("div",r,[(0,a.bF)(d),(0,a.bF)(m)])):((0,a.uX)(),(0,a.Wv)(s,{key:0}))])],512),[[o.aG,!l.isAdmin]]),(0,a.bo)((0,a.Lk)("div",null,[(0,a.Lk)("div",null,[u.isLogin?((0,a.uX)(),(0,a.CE)("div",i,[(0,a.bF)(p),(0,a.bF)(g)])):((0,a.uX)(),(0,a.Wv)(f,{key:0}))])],512),[[o.aG,l.isAdmin]]),(0,a.bF)(v)])}n(4979);var c=n(144),u=n(973),s=n(4232);const d=(0,a.Lk)("p",null,"홍길동 접속중..",-1),m=(0,a.Lk)("p",null,"로그아웃",-1),f=[m],p=(0,a.Lk)("h2",null,"대화",-1),g=(0,a.Lk)("p",null,"질문이 있으신가요? 지금 문의하세요!",-1),v=(0,a.Lk)("p",null,"온라인 문의가 가능한 상태입니다.",-1),h=(0,a.Lk)("p",null,"안녕하세요! 어떻게 도와드릴까요?",-1);function k(e,t,n,o,r,i){const l=(0,a.g2)("ChatModal");return(0,a.uX)(),(0,a.CE)("div",null,[(0,a.eW)(" 헤더 "),d,(0,a.Lk)("a",{onClick:t[0]||(t[0]=(...e)=>o.fn_kakaoLogout&&o.fn_kakaoLogout(...e))},f),(0,a.Lk)("button",{onClick:t[1]||(t[1]=(...e)=>o.openChatModal&&o.openChatModal(...e))},"실시간 채팅 상담(챗 모달 팝업)"),(0,a.bF)(l,{modelValue:o.isModalVisible,"onUpdate:modelValue":t[2]||(t[2]=e=>o.isModalVisible=e),userId:o.userId,nick:o.nick,role:o.role,chatroomId:o.chatroomId},{default:(0,a.k6)((()=>[p,g,v,(0,a.Lk)("div",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.activeAdmin,((e,t)=>((0,a.uX)(),(0,a.CE)("div",{key:t},(0,s.v_)(e),1)))),128))]),h])),_:1},8,["modelValue","userId","nick","role","chatroomId"])])}var b=n(5733),L=n(4373),y={components:{ChatModal:b.A},setup(){const e=(0,u.rd)(),t=(0,c.KR)(localStorage.getItem("id")),n=(0,c.KR)(localStorage.getItem("nick")),o=(0,c.KR)("USR"),r=(0,c.KR)(!1),i=(0,c.KR)("");let l=null,s=(0,c.KR)([]);const d=()=>{window.Kakao.Auth.logout((t=>{t&&(localStorage.setItem("isAuthenticated",!1),localStorage.setItem("id",""),localStorage.setItem("nick","")),e.go("/")}))},m=()=>{console.log("fnc openModal"),L.A.post("/api/chat/create",{id:t.value,nick:n.value}).then((e=>{console.log(e.data.chatroomId),i.value=e.data.chatroomId,r.value=!0}))},f=()=>{l=new WebSocket("ws://localhost:9090/ws/adminOnList"),l.onopen=()=>{console.log("activeAdminChkSocket connection opened")},l.onmessage=e=>{let t=e.data,n=t.split(",");console.log(n),s.value=n,console.log(s)},l.onclose=()=>{console.log("activeAdminChkSocket connection closed")},l.onerror=e=>{console.error("activeAdminChkSocket error: ",e)}};return(0,a.sV)((()=>{f()})),(0,a.hi)((()=>{l&&l.close()})),{userId:t,nick:n,role:o,isModalVisible:r,chatroomId:i,activeAdmin:s,fn_kakaoLogout:d,openChatModal:m,openActiveAdminChkSocket:f}}},A=n(1241);const C=(0,A.A)(y,[["render",k]]);var S=C;function w(e,t){const n=(0,a.g2)("router-link");return(0,a.uX)(),(0,a.CE)("div",null,[(0,a.eW)(" 왼쪽메뉴 "),(0,a.bF)(n,{to:"/chat/list"},{default:(0,a.k6)((()=>[(0,a.eW)("채팅 이력")])),_:1})])}const E={},I=(0,A.A)(E,[["render",w]]);var _=I;const W=(0,a.Lk)("img",{src:"//k.kakaocdn.net/14/dn/btqCn0WEmI3/nijroPfbpCa4at5EIsjyf0/o.jpg",width:"222"},null,-1),M=[W];function K(e,t,n,o,r,i){return(0,a.uX)(),(0,a.CE)("div",null,[(0,a.Lk)("a",{onClick:t[0]||(t[0]=(...e)=>i.fn_kakaoLogin&&i.fn_kakaoLogin(...e))},M)])}var O={methods:{fn_kakaoLogin(){window.Kakao.Auth.login({scope:"profile_nickname",success:this.fn_getKakaoAccount})},fn_getKakaoAccount(){window.Kakao.API.request({url:"/v2/user/me",success:e=>{var t=e.id,n=e.kakao_account.profile.nickname;localStorage.setItem("isAuthenticated",!0),localStorage.setItem("id",t),localStorage.setItem("nick",n),localStorage.setItem("role","USR"),this.$router.go("/chat/list")},fail:e=>{console.log(e),localStorage.setItem("isAuthenticated",!1)}})}}};const X=(0,A.A)(O,[["render",K]]);var j=X;function R(e,t){return(0,a.uX)(),(0,a.CE)("div",null,"user home")}const N={},F=(0,A.A)(N,[["render",R]]);var V=F;function x(e,t,n,o,r,i){const l=(0,a.g2)("router-link");return(0,a.uX)(),(0,a.CE)("div",null,[(0,a.Lk)("a",{onClick:t[0]||(t[0]=(...e)=>o.handleLogout&&o.handleLogout(...e))},"로그아웃"),(0,a.bF)(l,{to:"/admin/chat/serviceList",class:"btn"},{default:(0,a.k6)((()=>[(0,a.eW)("실시간 채팅 지원(채팅 지원 페이지)")])),_:1})])}var T={setup(){const e=(0,u.rd)(),t=()=>{localStorage.removeItem("jwt"),localStorage.removeItem("adminId"),localStorage.removeItem("adminNick"),e.go("/admin")};return{handleLogout:t}}};const D=(0,A.A)(T,[["render",x]]);var P=D;function $(e,t){const n=(0,a.g2)("router-link");return(0,a.uX)(),(0,a.CE)("div",null,[(0,a.eW)(" 왼쪽메뉴 "),(0,a.bF)(n,{to:"/admin/chat/mnglist"},{default:(0,a.k6)((()=>[(0,a.eW)("채팅관리")])),_:1}),(0,a.bF)(n,{to:"/admin/chat/serviceList"},{default:(0,a.k6)((()=>[(0,a.eW)("실시간 채팅 지원")])),_:1}),(0,a.bF)(n,{to:"/admin/chat/empty"},{default:(0,a.k6)((()=>[(0,a.eW)("빈페이지")])),_:1})])}const H={},U=(0,A.A)(H,[["render",$]]);var q=U;const B=e=>((0,a.Qi)("data-v-9ed5a128"),e=e(),(0,a.jt)(),e),J={class:"login"},G=B((()=>(0,a.Lk)("h1",null,"Login",-1))),Q=B((()=>(0,a.Lk)("label",{for:"username"},"Id:",-1))),Y=B((()=>(0,a.Lk)("label",{for:"password"},"Password:",-1))),z=B((()=>(0,a.Lk)("button",{type:"submit"},"Login",-1))),Z={key:0,class:"error"};function ee(e,t,n,r,i,l){return(0,a.uX)(),(0,a.CE)("div",J,[G,(0,a.Lk)("form",{onSubmit:t[2]||(t[2]=(0,o.D$)(((...e)=>l.handleLogin&&l.handleLogin(...e)),["prevent"]))},[(0,a.Lk)("div",null,[Q,(0,a.bo)((0,a.Lk)("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>i.id=e),id:"id",required:""},null,512),[[o.Jo,i.id]])]),(0,a.Lk)("div",null,[Y,(0,a.bo)((0,a.Lk)("input",{type:"password","onUpdate:modelValue":t[1]||(t[1]=e=>i.password=e),id:"password",required:""},null,512),[[o.Jo,i.password]])]),z,i.error?((0,a.uX)(),(0,a.CE)("div",Z,(0,s.v_)(i.error),1)):(0,a.Q3)("",!0)],32)])}var te={data(){return{id:"",password:"",error:""}},methods:{async handleLogin(){try{const e=await L.A.post("/api/admin/login",{id:this.id,pw:this.password}),t=e.data.jwt,n=e.data.nick;localStorage.setItem("jwt",t),localStorage.setItem("adminNick",n),localStorage.setItem("adminId",this.id),this.$router.go("/admin/chat/mnglist")}catch(e){this.error="Login failed: "+(e.response?.data?.message||"Unknown error"),this.$router.go("/admin")}}}};const ne=(0,A.A)(te,[["render",ee],["__scopeId","data-v-9ed5a128"]]);var oe=ne;function ae(e,t){return(0,a.uX)(),(0,a.CE)("div",null,"admin home")}const re={},ie=(0,A.A)(re,[["render",ae]]);var le=ie,ce={name:"App",components:{Header:S,LeftMenu:_,Login:j,AdminHeader:P,AdminLeftMenu:q,AdminLogin:oe,Home:V,AdminHome:le},setup(){const e=(0,u.lq)(),t=(0,u.rd)(),n=(0,c.KR)(!1),o=()=>{n.value=e.path.startsWith("/admin")};return t.afterEach(((e,t)=>{o()})),{isAdmin:n}},mounted(){this.isAdmin=this.$route.path.startsWith("/admin")},computed:{isLogin(){const e="true"===localStorage.getItem("isAuthenticated");let t;const n=localStorage.getItem("jwt");n||(t=!1);try{const e=JSON.parse(atob(n.split(".")[1])),o=e.exp&&Date.now()/1e3>e.exp;t=!o}catch(o){t=!1}return this.isAdmin?t:e}}};const ue=(0,A.A)(ce,[["render",l]]);var se=ue;const de=[{path:"/",name:"Home",component:V},{path:"/chat/list",name:"ChatList",component:()=>n.e(780).then(n.bind(n,780))},{path:"/admin",name:"AdminHome",component:le},{path:"/admin/chat/mnglist",name:"AdminChatManage",component:()=>n.e(980).then(n.bind(n,2980))},{path:"/admin/chat/serviceList",name:"AdminChatService",component:()=>n.e(40).then(n.bind(n,1040))},{path:"/admin/chat/empty",name:"AdminEmpty",component:()=>n.e(913).then(n.bind(n,2913))}],me=(0,u.aE)({history:(0,u.LA)(),routes:de});var fe=me;const pe=(0,o.Ef)(se).use(fe);pe.config.globalProperties.$axios=L.A,pe.mount("#app")},5733:function(e,t,n){n.d(t,{A:function(){return d}});var o=n(6768),a=n(5130),r=n(4232);function i(e,t,n,i,l,c){return i.visible?((0,o.uX)(),(0,o.CE)("div",{key:0,class:"modal-overlay",onClick:t[7]||(t[7]=(0,a.D$)(((...e)=>i.close&&i.close(...e)),["self"]))},[(0,o.Lk)("div",{class:"modal-content",ref:"modalContent",onMousedown:t[4]||(t[4]=(...e)=>i.startDrag&&i.startDrag(...e)),onMouseup:t[5]||(t[5]=(...e)=>i.stopDrag&&i.stopDrag(...e)),onMousemove:t[6]||(t[6]=(...e)=>i.drag&&i.drag(...e))},[(0,o.Lk)("button",{class:"modal-close",onClick:t[0]||(t[0]=(...e)=>i.close&&i.close(...e))},"×"),(0,o.RG)(e.$slots,"default",{},void 0,!0),(0,o.bo)((0,o.Lk)("div",null,null,512),[[a.aG,"USR"==i.role]]),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(i.messages,((e,t)=>((0,o.uX)(),(0,o.CE)("div",{key:t},[(0,o.Lk)("p",null,(0,r.v_)(e.nick)+" : "+(0,r.v_)(e.content),1)])))),128)),(0,o.Lk)("div",null,[(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>i.message=e),placeholder:"메시지 작성.."},null,512),[[a.Jo,i.message]]),(0,o.Lk)("button",{onClick:t[2]||(t[2]=(...e)=>i.sendMessage&&i.sendMessage(...e))},"전송"),(0,o.Lk)("button",{onClick:t[3]||(t[3]=(...e)=>i.close&&i.close(...e))},"종료")])],544)])):(0,o.Q3)("",!0)}n(4114);var l=n(144),c={props:{modelValue:{type:Boolean,default:!1},userId:{type:String,default:""},nick:{type:String,default:""},role:{type:String,default:""},chatroomId:{type:String,default:""}},setup(e,{emit:t}){const n=(0,o.EW)((()=>e.userId)),a=(0,o.EW)((()=>e.nick)),r=(0,o.EW)((()=>e.role));let i=(0,o.EW)((()=>e.chatroomId));const c=(0,l.KR)(e.modelValue),u=(0,l.KR)(null);let s=(0,l.KR)(!1),d=0,m=0,f=0,p=0;const g=(0,l.KR)("");let v=(0,l.KR)([]),h=null;const k=e=>{let t="ENTER"===e?`${a.value}님이 입장하였습니다.`:g.value;console.log(i.value+" in the modal");const o={chatroomId:i.value,id:n.value,nick:a.value,content:t,type:e};return o},b=()=>{y(k("TALK")),g.value=""},L=()=>{console.log("enter"),y(k("ENTER"))},y=e=>{h.readyState===WebSocket.OPEN?h.send(JSON.stringify(e)):console.error("WebSocket is not open")},A=()=>{h=new WebSocket("ws://localhost:9090/ws/chat"),h.onopen=()=>{console.log("WebSocket connection opened"),L("ENTER")},h.onmessage=e=>{let t=JSON.parse(e.data),n={nick:t.nick,content:t.content};v.value.push(n)},h.onclose=()=>{console.log("WebSocket connection closed")},h.onerror=e=>{console.error("WebSocket error: ",e)}},C=()=>{i.value="",v.value=[],h.close(),t("update:modelValue",!1)},S=e=>{s.value=!0,d=e.clientX,m=e.clientY;const t=u.value.getBoundingClientRect();f=t.left,p=t.top},w=()=>{s.value=!1},E=e=>{if(!s.value)return;const t=e.clientX-d,n=e.clientY-m;u.value.style.left=`${f+t}px`,u.value.style.top=`${p+n}px`};return(0,o.wB)((()=>e.modelValue),(e=>{c.value=e,e&&(null!==h&&h.readyState!==WebSocket.CLOSED||A())})),(0,o.sV)((()=>{})),{userId:n,nick:a,role:r,chatroomId:i,visible:c,close:C,modalContent:u,startDrag:S,stopDrag:w,drag:E,websocket:h,message:g,messages:v,sendWebSocket:y,sendMessage:b}}},u=n(1241);const s=(0,u.A)(c,[["render",i],["__scopeId","data-v-4756beed"]]);var d=s}},t={};function n(o){var a=t[o];if(void 0!==a)return a.exports;var r=t[o]={exports:{}};return e[o].call(r.exports,r,r.exports,n),r.exports}n.m=e,function(){var e=[];n.O=function(t,o,a,r){if(!o){var i=1/0;for(s=0;s<e.length;s++){o=e[s][0],a=e[s][1],r=e[s][2];for(var l=!0,c=0;c<o.length;c++)(!1&r||i>=r)&&Object.keys(n.O).every((function(e){return n.O[e](o[c])}))?o.splice(c--,1):(l=!1,r<i&&(i=r));if(l){e.splice(s--,1);var u=a();void 0!==u&&(t=u)}}return t}r=r||0;for(var s=e.length;s>0&&e[s-1][2]>r;s--)e[s]=e[s-1];e[s]=[o,a,r]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){n.f={},n.e=function(e){return Promise.all(Object.keys(n.f).reduce((function(t,o){return n.f[o](e,t),t}),[]))}}(),function(){n.u=function(e){return"js/"+e+"."+{40:"f320d7e3",780:"003a64bd",913:"ba9728fe",980:"e1953433"}[e]+".js"}}(),function(){n.miniCssF=function(e){return"css/"+e+"."+{780:"295b7dc8",980:"295b7dc8"}[e]+".css"}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={},t="test1:";n.l=function(o,a,r,i){if(e[o])e[o].push(a);else{var l,c;if(void 0!==r)for(var u=document.getElementsByTagName("script"),s=0;s<u.length;s++){var d=u[s];if(d.getAttribute("src")==o||d.getAttribute("data-webpack")==t+r){l=d;break}}l||(c=!0,l=document.createElement("script"),l.charset="utf-8",l.timeout=120,n.nc&&l.setAttribute("nonce",n.nc),l.setAttribute("data-webpack",t+r),l.src=o),e[o]=[a];var m=function(t,n){l.onerror=l.onload=null,clearTimeout(f);var a=e[o];if(delete e[o],l.parentNode&&l.parentNode.removeChild(l),a&&a.forEach((function(e){return e(n)})),t)return t(n)},f=setTimeout(m.bind(null,void 0,{type:"timeout",target:l}),12e4);l.onerror=m.bind(null,l.onerror),l.onload=m.bind(null,l.onload),c&&document.head.appendChild(l)}}}(),function(){n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){n.p="/"}(),function(){if("undefined"!==typeof document){var e=function(e,t,o,a,r){var i=document.createElement("link");i.rel="stylesheet",i.type="text/css",n.nc&&(i.nonce=n.nc);var l=function(n){if(i.onerror=i.onload=null,"load"===n.type)a();else{var o=n&&n.type,l=n&&n.target&&n.target.href||t,c=new Error("Loading CSS chunk "+e+" failed.\n("+o+": "+l+")");c.name="ChunkLoadError",c.code="CSS_CHUNK_LOAD_FAILED",c.type=o,c.request=l,i.parentNode&&i.parentNode.removeChild(i),r(c)}};return i.onerror=i.onload=l,i.href=t,o?o.parentNode.insertBefore(i,o.nextSibling):document.head.appendChild(i),i},t=function(e,t){for(var n=document.getElementsByTagName("link"),o=0;o<n.length;o++){var a=n[o],r=a.getAttribute("data-href")||a.getAttribute("href");if("stylesheet"===a.rel&&(r===e||r===t))return a}var i=document.getElementsByTagName("style");for(o=0;o<i.length;o++){a=i[o],r=a.getAttribute("data-href");if(r===e||r===t)return a}},o=function(o){return new Promise((function(a,r){var i=n.miniCssF(o),l=n.p+i;if(t(i,l))return a();e(o,l,null,a,r)}))},a={524:0};n.f.miniCss=function(e,t){var n={780:1,980:1};a[e]?t.push(a[e]):0!==a[e]&&n[e]&&t.push(a[e]=o(e).then((function(){a[e]=0}),(function(t){throw delete a[e],t})))}}}(),function(){var e={524:0};n.f.j=function(t,o){var a=n.o(e,t)?e[t]:void 0;if(0!==a)if(a)o.push(a[2]);else{var r=new Promise((function(n,o){a=e[t]=[n,o]}));o.push(a[2]=r);var i=n.p+n.u(t),l=new Error,c=function(o){if(n.o(e,t)&&(a=e[t],0!==a&&(e[t]=void 0),a)){var r=o&&("load"===o.type?"missing":o.type),i=o&&o.target&&o.target.src;l.message="Loading chunk "+t+" failed.\n("+r+": "+i+")",l.name="ChunkLoadError",l.type=r,l.request=i,a[1](l)}};n.l(i,c,"chunk-"+t,t)}},n.O.j=function(t){return 0===e[t]};var t=function(t,o){var a,r,i=o[0],l=o[1],c=o[2],u=0;if(i.some((function(t){return 0!==e[t]}))){for(a in l)n.o(l,a)&&(n.m[a]=l[a]);if(c)var s=c(n)}for(t&&t(o);u<i.length;u++)r=i[u],n.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return n.O(s)},o=self["webpackChunktest1"]=self["webpackChunktest1"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=n.O(void 0,[504],(function(){return n(2371)}));o=n.O(o)})();
//# sourceMappingURL=app.5719bd94.js.map